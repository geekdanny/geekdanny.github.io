<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>极客丹尼 - 每天进步一点</title><meta name="keywords" content="‘科技’"><meta name="author" content="Danny S."><meta name="copyright" content="Danny S."><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="白羊男子 指尖微凉 一半明媚 一半忧伤">
<meta property="og:type" content="website">
<meta property="og:title" content="极客丹尼">
<meta property="og:url" content="https://broadgeek.com/page/3/index.html">
<meta property="og:site_name" content="极客丹尼">
<meta property="og:description" content="白羊男子 指尖微凉 一半明媚 一半忧伤">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/geekdanny/images/master/avatar.jpg">
<meta property="article:author" content="Danny S.">
<meta property="article:tag" content="‘科技’">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/geekdanny/images/master/avatar.jpg"><link rel="shortcut icon" href="https://raw.githubusercontent.com/geekdanny/images/master/kirito.ico"><link rel="canonical" href="https://broadgeek.com/page/3/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ma+Shan+Zheng" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '极客丹尼',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2022-04-21 15:35:14'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="极客丹尼" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://raw.githubusercontent.com/geekdanny/images/master/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">53</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">50</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://source.unsplash.com/random/1920x1080')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">极客丹尼</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">极客丹尼</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/geekdanny" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:dhrsongcs@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2021/01/12/2236/" title="Setup OpenGL Development with Clion on MacOS"><img class="post_bg" src="https://raw.githubusercontent.com/geekdanny/images/master/blog/qiyvUd.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Setup OpenGL Development with Clion on MacOS"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/01/12/2236/" title="Setup OpenGL Development with Clion on MacOS">Setup OpenGL Development with Clion on MacOS</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-01-12T19:06:07.000Z" title="发表于 2021-01-12 11:06:07">2021-01-12</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-01-12T19:06:07.000Z" title="更新于 2021-01-12 11:06:07">2021-01-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%9B%BE%E5%BD%A2%E6%8A%80%E6%9C%AF/">图形技术</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/OpenGL/">OpenGL</a></span></div><div class="content">前言伴随图形学课程进入中后期，我们也不能光讲理论，不做实践。在2021年的岁月里，让我们“撸起袖子加油干”！
今天，我们从比较容易上手的OpenGL开始。
这门课程的前置基础：

杂货铺里Danny之前写的图形学入门课程
C/C++编程语言

开发环境：

Mac OS， Clion， XCode

或者

Windows，Clion，Visual Studio 2016。

为了统一大家的开发环境，这门课里采用Clion。本人的工作环境是Macbook，所以接下来的内容主要会围绕Macbook+Clion环境配置OpenGL来讲解。
配置C/C++开发环境第一步：Install BrewBrew 是Macbook上用来安装和管理各种工具的的command工具。
安装方法如下：
1/bin/bash -c &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)&quot;

第二步：确认自己的MacOS上安装了gcc：1~ ❯❯❯ gcc --version       ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2021/01/12/2270/" title="Setup Vulkan Development Environment with Clion on MacOS"><img class="post_bg" src="https://raw.githubusercontent.com/geekdanny/images/master/blog/FtU9D7.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Setup Vulkan Development Environment with Clion on MacOS"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/01/12/2270/" title="Setup Vulkan Development Environment with Clion on MacOS">Setup Vulkan Development Environment with Clion on MacOS</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-01-12T19:06:07.000Z" title="发表于 2021-01-12 11:06:07">2021-01-12</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-01-12T19:06:07.000Z" title="更新于 2021-01-12 11:06:07">2021-01-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%9B%BE%E5%BD%A2%E6%8A%80%E6%9C%AF/">图形技术</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Vulkan/">Vulkan</a></span></div><div class="content">前言学习图形学编程的时候，其实在MacOS的编程环境默认都是用Xcode，Windows又经常用Visual Studio。但是因为我经常要在Windows 和 MacOS上切换编程，偶尔还得跑到Ubuntu上去，也不想反复的切换不同的IDE，所以我选择了Clion。Clion 好的好处就是跨平台的使用。
今天花了几个小时在MacOS上配置了Clion+Vulkan的开发环境，对于后期学习Vulkan做铺垫。 了解Clion的人都知道，Clion的C/C++编程采用的是cmake 做工程构建，这样子又可以逼迫我使用一个跨平台的构架方案，对于底层的工程构建可以了如指掌，也可使促我更进一步的了解和学习cmake。
我的工作环境MacOS: Big Sur
gcc verson123456~/C/V/shaders ❯❯❯ gcc --versionConfigured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/Library/Developer/CommandL ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2021/01/11/b21/" title="Vulkan 导读3: 分配Image资源和创建Swapchain"><img class="post_bg" src="https://raw.githubusercontent.com/geekdanny/images/master/blog/image-20210111155306450.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Vulkan 导读3: 分配Image资源和创建Swapchain"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/01/11/b21/" title="Vulkan 导读3: 分配Image资源和创建Swapchain">Vulkan 导读3: 分配Image资源和创建Swapchain</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-01-11T23:18:14.000Z" title="发表于 2021-01-11 15:18:14">2021-01-11</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-01-11T23:18:14.000Z" title="更新于 2021-01-11 15:18:14">2021-01-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%9B%BE%E5%BD%A2%E6%8A%80%E6%9C%AF/">图形技术</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Vulkan/">Vulkan</a></span></div><div class="content">导读2学习了CB和内存管理。这一节对《Learning Vulkan》的第6章的导读。特介绍了两个主要概念，一个是image resources，另一个是swapchain 和 depth image。
主要内容如下：

Getting started with image resources
Understanding an image resource
Memory allocation and binding an image resource
Introducing swapchains
Creating a depth image
Summarizing the application flow

Getting started with image resourcesVulkan 的资源主要分成两种: 1. image; 2 buffer. 书中的第六章主要是讲解image resources。第七章开始讲解了buffer resources。 image resoure 主要是被用来创建swapchain。
Vulkan的images 主要为contiguous text ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2021/01/11/7c7/" title="Vulkan 导读2: Command Buffer 和内存管理"><img class="post_bg" src="https://raw.githubusercontent.com/geekdanny/images/master/blog/NFrL2w.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Vulkan 导读2: Command Buffer 和内存管理"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/01/11/7c7/" title="Vulkan 导读2: Command Buffer 和内存管理">Vulkan 导读2: Command Buffer 和内存管理</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-01-11T22:26:51.000Z" title="发表于 2021-01-11 14:26:51">2021-01-11</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-01-11T22:26:51.000Z" title="更新于 2021-01-11 14:26:51">2021-01-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%9B%BE%E5%BD%A2%E6%8A%80%E6%9C%AF/">图形技术</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Vulkan/">Vulkan</a></span></div><div class="content">导读2 主要是讲解第五章，之所以跳过2，3，4章是因为这三章关键概念很少，更多的是围绕Vulkan初始化阶段的准备工作。第五章重点讲解了CB和内存的概念，值得对其细节进行整理。
一个command buffer就是a collection of commands. Command buffer 会被提交到一个合适的 hardware queue 让GPU来处理。driver会fetches和validates并compiles这些command buffers，然后再把它们交给GPU来处理。这一章节主要围绕command buffers 和 memory allocation的讲解了以下topics：

Getting started with command buffers
Understanding the command pool and command buffer APIs
Recording command buffers
Implementing the command buffer wrapper class
Managing memory in Vulkan

Get ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2021/01/11/59e9/" title="Vulkan 导读1: 下一代图形API"><img class="post_bg" src="https://raw.githubusercontent.com/geekdanny/images/master/blog/640.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Vulkan 导读1: 下一代图形API"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/01/11/59e9/" title="Vulkan 导读1: 下一代图形API">Vulkan 导读1: 下一代图形API</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-01-11T22:06:46.000Z" title="发表于 2021-01-11 14:06:46">2021-01-11</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-01-11T22:06:46.000Z" title="更新于 2021-01-11 14:06:46">2021-01-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%9B%BE%E5%BD%A2%E6%8A%80%E6%9C%AF/">图形技术</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Vulkan/">Vulkan</a></span></div><div class="content">写在之前：此篇为Danny针对《Learning Vulkan》一书的导读。导读的目的主要是将一些重要的概念重点归纳和解释，并对不清楚的概念提出疑问，作为后续工作和学习中的待澄清点。
Danny认为，一本好的书，是可以加深技术理解，自画自圆，其义自见的；一本不好的书，要靠读者去猜，搜索很多其他补助资料才能澄清。优秀的书是可以从全局观开始，聚焦到细节。一本不好的书，说的都是正确的废话。 最近读了两本关于Vulkan的书，一本是电子版的《Learning Vulkan》。

一本是花了$175购买的纸质的《Computer Graphics and the Vulkan API》
两本书都是对下一代图形API的细节展开，Danny希望通过一种导读的形式来将这两本书的一些重要概念融合一下。写这篇文章的内容不是说大家看导读就不用去读书了，而是希望辅助大家阅读图书。如今的时代都是速食知识消费，time is money。 大家都没有时间，但是这种速食知识消费很容易让大家知其然而不知其所以然。
导读的梳理其实比较耗时间。技术读物不像读小说那样可以进行速读，阅读过程要注意的环节是避免眼球回跳。但是， ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2020/06/29/c305/" title="C++ 的函数模板和类模板"><img class="post_bg" src="https://raw.githubusercontent.com/geekdanny/images/master/blog/1h1sR8.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C++ 的函数模板和类模板"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/06/29/c305/" title="C++ 的函数模板和类模板">C++ 的函数模板和类模板</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-06-29T23:57:18.000Z" title="发表于 2020-06-29 16:57:18">2020-06-29</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-06-29T23:57:18.000Z" title="更新于 2020-06-29 16:57:18">2020-06-29</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/">编程技术</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/C/">C++</a></span></div><div class="content">介绍C++提供函数模板（function template）。所谓的函数模板，实际上是建立一个通用函数，其函数的类型和形参类型不具体制定，有一个虚拟的那类型来代表。这个通用函数就成为函数模板。凡是函数体相同的函数都可以用这个模板来代替，不必定义多个函数，只需在末班中定义一次即可。在调用函数时，系统会根据形参的类型来取代模板的虚拟类型，从而实现了不同函数的功能。

C++ 提供两种模板机制： 函数模板，类模板来进行泛型编程

类属 – 类型参数化，又称参数模板
使程序（算法）可以从逻辑功能上抽象，把被处理的对象（数据）类型作为参数传递。


总结：

模板把函数或类要处理的数据类型参数化，表现为参数的多态性，成为类属。
模板用于表达逻辑的结构相同，但具体数据元素类型不同的数据对象的通用行为。
让算法和数据类型分离

函数模板为什么要有函数模板当函数业务逻辑相同但参数不同时，我们就需要用到函数模板。
函数模板做函数参数的本质是类型参数化，好处就是可以编写与类型无关的代码；
注意：模板的声明或定义只能在全局，命名空间或类范围内进行。即不能在局部范围，函数内进行，比如不能在main函数中声明或 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2020/06/29/584/" title="C++：在堆上创建对象，还是在栈上?"><img class="post_bg" src="https://raw.githubusercontent.com/geekdanny/images/master/blog/DPCqUP.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C++：在堆上创建对象，还是在栈上?"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/06/29/584/" title="C++：在堆上创建对象，还是在栈上?">C++：在堆上创建对象，还是在栈上?</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-06-29T21:29:21.000Z" title="发表于 2020-06-29 14:29:21">2020-06-29</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-06-29T21:29:21.000Z" title="更新于 2020-06-29 14:29:21">2020-06-29</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/">编程技术</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/C/">C++</a></span></div><div class="content">本文参考自：https://www.devbean.net/2014/02/cpp-create-object-on-heap-or-stack/  觉得对初学者有些帮助。
关于究竟是在堆上还是在栈上创建对象，可能很多初学者感到迷惑。我想可以把这部分内容拿出来详细介绍一下。现在，假设你已经清楚什么是堆，什么是栈。
如果需要在堆上创建对象，要么使用new运算符，要么使用malloc系列函数。这点没有异议。
真正有异议的是下面的代码：
1Object obj;

此时，obj是在栈上分配的吗？
要回答这个问题，我们首先要理解这个语句是什么意思。这个语句就是代表着，在栈上创建对象吗？
其实，这行语句的含义是，使对象obj具有“自动存储（automatic storage）”的性质。所谓“自动存储”，意思是这个对象的存储位置取决于其声明所在的上下文。

如果这个语句出现在函数内部，那么它就在栈上创建对象。
如果这个语句不是在函数内部，而是作为一个类的成员变量，则取决于这个类的对象是如何分配的。

考虑下面的代码：
123456class Class&#123;    Object obj;&# ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2020/06/29/52b1/" title="struct vs class in C++"><img class="post_bg" src="https://raw.githubusercontent.com/geekdanny/images/master/blog/P1F4HC.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="struct vs class in C++"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/06/29/52b1/" title="struct vs class in C++">struct vs class in C++</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-06-29T18:39:35.000Z" title="发表于 2020-06-29 11:39:35">2020-06-29</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-06-29T18:39:35.000Z" title="更新于 2020-06-29 11:39:35">2020-06-29</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/">编程技术</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/C/">C++</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/struct/">struct</a></span></div><div class="content">基本区别struct 由c语言引入。在c语言中，是定义结构化数据的标准选择。其主观上的定义可参考：https://zh-google-styleguide.readthedocs.io/en/latest/google-cpp-styleguide/classes/#vs
c++ 同时支持struct 和 class. 原因之一是c++ 是 c 的超集，涵盖c 已支持的语言要素，将更好的支持向下兼容(原来能够工作的c 源程序移植到c++，可以支付极少甚至0代价)。首先我们来看结构体在C和C++中的区别。
C语言中的结构体C语言中的结构体不能为空，否则会报错要求一个结构或联合至少有一个成员
C语言中的结构体只涉及到数据结构，而不涉及到算法.也就是说在C中数据结构和算法是分离的。换句话说就是C语言中的结构体只能定义成员变量，但是不能定义成员函数。然而在C++中既可以定义成员变量又可以定义成员函数， C++中的结构体和类体现了数据结构和算法的结合。 不过虽然C语言的结构体中不能定义成员函数，但是却可以定义函数指针，不过函数指针本质上不是函数而是指针，所以总的来说C语言中的结构体只是一个复杂数 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2020/06/22/5fe2/" title="Data Type in C"><img class="post_bg" src="https://raw.githubusercontent.com/geekdanny/images/master/blog/3Qme5j.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Data Type in C"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/06/22/5fe2/" title="Data Type in C">Data Type in C</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-06-22T20:40:58.000Z" title="发表于 2020-06-22 13:40:58">2020-06-22</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-06-22T20:40:58.000Z" title="更新于 2020-06-22 13:40:58">2020-06-22</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/">编程技术</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/C/">C</a></span></div><div class="content">Data Type Encapulationvoid means “no type”. void * means “a pointer with no type”. void * can point to any type of address.

Usage 1: void is to encapulate the data type

int initHardEnv(void ** handle). A typical example is memory opertation functions such as memcpy and memset
void * memcpy(void * dest, const void * src, size_t len);
void * memset(void * buffer, int c, size_t num);




Usage 2: void is to describe the return value and parameters. It only means “empty” or “nothing”. 

If a funct ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2020/06/21/ab5f/" title="Design Patterns-Single Responsibility Principle"><img class="post_bg" src="https://raw.githubusercontent.com/geekdanny/images/master/blog/gbkQcf.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Design Patterns-Single Responsibility Principle"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/06/21/ab5f/" title="Design Patterns-Single Responsibility Principle">Design Patterns-Single Responsibility Principle</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-06-21T19:52:27.000Z" title="发表于 2020-06-21 12:52:27">2020-06-21</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-06-21T19:52:27.000Z" title="更新于 2020-06-21 12:52:27">2020-06-21</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/">架构设计</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/C/">C++</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/Design-Patterns/">Design Patterns</a></span></div><div class="content">Introduction
Design patters are common architecture approaches.  (是架构的设计的具体应用方法论)
Students in Software Engineering Major are usually requirde to take the design patterns in their 3rd year program.
Popularized by the Gang of Fours book, 1994 – Smalltalk &amp; C++
Translated to many OOP languages: C#, Jav


Course Structure
Creational (创建型)
Structual （结构型）
Behavioral （行为型）
About Me
Software Coach in 2012 Software Engineering Lab

The SOLID Design PrinciplesSOLID is an acronym which stands for the  ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/2/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/#content-inner">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/#content-inner">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/#content-inner">6</a><a class="extend next" rel="next" href="/page/4/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://raw.githubusercontent.com/geekdanny/images/master/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Danny S.</div><div class="author-info__description">白羊男子 指尖微凉<br> 一半明媚 一半忧伤</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">53</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">50</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://raw.githubusercontent.com/geekdanny/images/master/wechat.jpg"><i class="fab fa-weixin"></i><span>微信</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/geekdanny" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:dhrsongcs@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">每天进步一点点</div></div><div class="sticky_layout"><div class="card-widget card-map"><div class="card-content"><div class="item-headline"><i class="fa fa-globe-asia" aria-hidden="true"></i><span>访客地图</span></div><script id="clstr_globe" type="text/javascript" defer="defer" src="//clustrmaps.com/globe.js?d=CojogHP_KQrVVdbDxLiXuCIzeE8Jp3_6j7HMEa08Ulw"></script></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/04/20/5398/" title="C标准库 POSIX库 glibc库有什么关系"><img src="https://s2.loli.net/2022/04/21/JVjPkp1tIU8xmZ6.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C标准库 POSIX库 glibc库有什么关系"/></a><div class="content"><a class="title" href="/2022/04/20/5398/" title="C标准库 POSIX库 glibc库有什么关系">C标准库 POSIX库 glibc库有什么关系</a><time datetime="2022-04-20T19:56:32.000Z" title="更新于 2022-04-20 12:56:32">2022-04-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/20/49da/" title="一些常见的国际标准化组织"><img src="https://s2.loli.net/2022/04/21/1wicXtVxAMlHZOf.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="一些常见的国际标准化组织"/></a><div class="content"><a class="title" href="/2022/04/20/49da/" title="一些常见的国际标准化组织">一些常见的国际标准化组织</a><time datetime="2022-04-20T19:07:33.000Z" title="更新于 2022-04-20 12:07:33">2022-04-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/12/dd3a/" title="骁龙8Gen1 SoC 在ARMv9上的落地表现"><img src="https://s2.loli.net/2021/12/13/f93YwJV1RTSMNbx.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="骁龙8Gen1 SoC 在ARMv9上的落地表现"/></a><div class="content"><a class="title" href="/2021/12/12/dd3a/" title="骁龙8Gen1 SoC 在ARMv9上的落地表现">骁龙8Gen1 SoC 在ARMv9上的落地表现</a><time datetime="2021-12-12T23:52:09.000Z" title="更新于 2021-12-12 15:52:09">2021-12-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/12/c8bf/" title="ARMv9以及公版CPU有什么重大改进"><img src="https://s2.loli.net/2021/12/13/ew5lOSUv6LWHtGr.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ARMv9以及公版CPU有什么重大改进"/></a><div class="content"><a class="title" href="/2021/12/12/c8bf/" title="ARMv9以及公版CPU有什么重大改进">ARMv9以及公版CPU有什么重大改进</a><time datetime="2021-12-12T18:04:13.000Z" title="更新于 2021-12-12 10:04:13">2021-12-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/11/17d7/" title="移动GPU测试那些事"><img src="https://n.sinaimg.cn/spider2021220/505/w2048h857/20210220/4c68-kkmphpr6926549.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="移动GPU测试那些事"/></a><div class="content"><a class="title" href="/2021/12/11/17d7/" title="移动GPU测试那些事">移动GPU测试那些事</a><time datetime="2021-12-11T18:38:27.000Z" title="更新于 2021-12-11 10:38:27">2021-12-11</time></div></div></div></div><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-comment-dots"></i><span>最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%9B%BD%E9%99%85%E7%BB%8F%E6%B5%8E/"><span class="card-category-list-name">国际经济</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%9B%BE%E5%BD%A2%E6%8A%80%E6%9C%AF/"><span class="card-category-list-name">图形技术</span><span class="card-category-list-count">9</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%B7%A5%E7%A8%8B%E5%B7%A5%E5%85%B7/"><span class="card-category-list-name">工程工具</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%BC%80%E5%8F%91%E8%BF%90%E7%BB%B4/"><span class="card-category-list-name">开发运维</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"><span class="card-category-list-name">操作系统</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/"><span class="card-category-list-name">架构设计</span><span class="card-category-list-count">5</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%A7%91%E6%8A%80%E8%A7%82%E5%AF%9F/"><span class="card-category-list-name">科技观察</span><span class="card-category-list-count">13</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/"><span class="card-category-list-name">编程技术</span><span class="card-category-list-count">7</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/%E8%8A%AF%E7%89%87/" style="font-size: 1.39em; color: rgb(94, 138, 80)">芯片</a><a href="/tags/%E5%8D%8E%E4%B8%BA/" style="font-size: 1.45em; color: rgb(10, 2, 174)">华为</a><a href="/tags/%E9%BA%92%E9%BA%9F/" style="font-size: 1.15em; color: rgb(186, 39, 67)">麒麟</a><a href="/tags/5G/" style="font-size: 1.15em; color: rgb(154, 60, 105)">5G</a><a href="/tags/%E8%AF%BB%E4%B9%A6%E8%AE%A1%E5%88%92/" style="font-size: 1.15em; color: rgb(36, 29, 86)">读书计划</a><a href="/tags/%E7%AB%9E%E5%93%81%E5%88%86%E6%9E%90/" style="font-size: 1.15em; color: rgb(13, 39, 130)">竞品分析</a><a href="/tags/ARM/" style="font-size: 1.21em; color: rgb(139, 147, 194)">ARM</a><a href="/tags/Android/" style="font-size: 1.27em; color: rgb(50, 91, 123)">Android</a><a href="/tags/C/" style="font-size: 1.39em; color: rgb(174, 7, 145)">C++</a><a href="/tags/C/" style="font-size: 1.21em; color: rgb(101, 65, 43)">C</a><a href="/tags/Linux/" style="font-size: 1.15em; color: rgb(83, 21, 114)">Linux</a><a href="/tags/Kernel/" style="font-size: 1.15em; color: rgb(160, 37, 122)">Kernel</a><a href="/tags/Design-Patterns/" style="font-size: 1.21em; color: rgb(108, 62, 127)">Design Patterns</a><a href="/tags/SIP/" style="font-size: 1.15em; color: rgb(191, 156, 151)">SIP</a><a href="/tags/Mali/" style="font-size: 1.15em; color: rgb(97, 25, 75)">Mali</a><a href="/tags/Github/" style="font-size: 1.15em; color: rgb(178, 78, 130)">Github</a><a href="/tags/GoDaddy/" style="font-size: 1.15em; color: rgb(104, 49, 62)">GoDaddy</a><a href="/tags/GPU/" style="font-size: 1.21em; color: rgb(48, 12, 20)">GPU</a><a href="/tags/React/" style="font-size: 1.15em; color: rgb(37, 176, 142)">React</a><a href="/tags/Architecture/" style="font-size: 1.15em; color: rgb(190, 112, 23)">Architecture</a><a href="/tags/Design/" style="font-size: 1.15em; color: rgb(159, 52, 88)">Design</a><a href="/tags/Hexo/" style="font-size: 1.21em; color: rgb(88, 166, 30)">Hexo</a><a href="/tags/Yuque/" style="font-size: 1.15em; color: rgb(11, 95, 177)">Yuque</a><a href="/tags/Mac/" style="font-size: 1.15em; color: rgb(91, 32, 136)">Mac</a><a href="/tags/%E7%BC%96%E8%AF%91%E7%8E%AF%E5%A2%83/" style="font-size: 1.15em; color: rgb(115, 54, 38)">编译环境</a><a href="/tags/OpenGL/" style="font-size: 1.15em; color: rgb(141, 173, 4)">OpenGL</a><a href="/tags/Vulkan/" style="font-size: 1.33em; color: rgb(98, 149, 23)">Vulkan</a><a href="/tags/Spring/" style="font-size: 1.21em; color: rgb(61, 123, 176)">Spring</a><a href="/tags/Springboot/" style="font-size: 1.21em; color: rgb(104, 139, 63)">Springboot</a><a href="/tags/IntelliJ/" style="font-size: 1.15em; color: rgb(120, 53, 54)">IntelliJ</a><a href="/tags/Java/" style="font-size: 1.15em; color: rgb(120, 16, 29)">Java</a><a href="/tags/Framework/" style="font-size: 1.15em; color: rgb(184, 157, 48)">Framework</a><a href="/tags/Compilation/" style="font-size: 1.15em; color: rgb(127, 152, 192)">Compilation</a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/" style="font-size: 1.15em; color: rgb(81, 52, 145)">计算机</a><a href="/tags/k8s/" style="font-size: 1.21em; color: rgb(110, 47, 73)">k8s</a><a href="/tags/ova/" style="font-size: 1.15em; color: rgb(6, 58, 4)">ova</a><a href="/tags/vmdk/" style="font-size: 1.15em; color: rgb(63, 163, 183)">vmdk</a><a href="/tags/ovftool/" style="font-size: 1.15em; color: rgb(43, 111, 77)">ovftool</a><a href="/tags/struct/" style="font-size: 1.15em; color: rgb(140, 27, 119)">struct</a><a href="/tags/%E5%8D%8A%E5%AF%BC%E4%BD%93%E8%A1%8C%E4%B8%9A/" style="font-size: 1.15em; color: rgb(187, 134, 3)">半导体行业</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/04/"><span class="card-archive-list-date">四月 2022</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/12/"><span class="card-archive-list-date">十二月 2021</span><span class="card-archive-list-count">8</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/11/"><span class="card-archive-list-date">十一月 2021</span><span class="card-archive-list-count">7</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/07/"><span class="card-archive-list-date">七月 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/04/"><span class="card-archive-list-date">四月 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/01/"><span class="card-archive-list-date">一月 2021</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/06/"><span class="card-archive-list-date">六月 2020</span><span class="card-archive-list-count">7</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/05/"><span class="card-archive-list-date">五月 2020</span><span class="card-archive-list-count">12</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">53</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2019-04-16T07:00:00.000Z"></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">113.7k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2022-04-21T22:35:14.229Z"></div></div></div></div></div></div></main><footer id="footer" style="background: black"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2022 By Danny S.</div><div class="footer_custom_text">回忆是一种重逢 遗忘是一种自由</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function subtitleType () {
  getScript('https://sdk.jinrishici.com/v2/browser/jinrishici.js').then(() => {
    jinrishici.load(result =>{
      if (true) {
        const sub = []
        const content = result.data.content
        sub.unshift(content)
        window.typed = new Typed('#subtitle', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('subtitle').innerHTML = result.data.content
      }
    })
  })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const findTrueUrl = (array) => {
    Promise.all(array.map(item =>
      fetch(item.url).then(resp => resp.json()).then(data => {
        const urlArray = data.body.match(/(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?/ig)
        if (data.user.login === 'utterances-bot') {
          return urlArray.pop()
        } else {
          return urlArray.shift()
        }
      })
    )).then(res => {
        array = array.map((i,index)=> {
          return {
            ...i,
            url: res[index]
          }
        })

        saveToLocal.set('github-newest-comments', JSON.stringify(array), 10/(60*24))
        generateHtml(array)
    });
  }

  const getComment = () => {
    fetch('https://api.github.com/repos/geekdanny/geek-comments/issues/comments?sort=updated&direction=desc&per_page=6&page=1',{
      "headers": {
        Accept: 'application/vnd.github.v3.html+json'
      }
    })
      .then(response => response.json())
      .then(data => {
        const githubArray = data.map(item => {
          return {
            'avatar': item.user.avatar_url,
            'content': changeContent(item.body_html),
            'nick': item.user.login,
            'url': item.issue_url,
            'date': item.updated_at,
            'githubUrl': item.html_url
          }
        })
        findTrueUrl(githubArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "无法获取评论，请确认相关配置是否正确"
      })
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('github-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><div class="aplayer no-destroy" data-id="4900141628" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-lrctype="1" data-preload="none" data-autoplay="true" muted></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.9}});</script></body></html>